# Generated by AgentForge
# Spec: agent_monitor
# Phase: green
# Date: 2025-12-31 05:35:32 UTC

from datetime import datetime
from enum import Enum
from typing import Optional, List
from dataclasses import dataclass


class ObservationType(Enum):
    ACTION = "action"
    OUTPUT = "output"
    VERIFICATION = "verification"
    STATE_CHANGE = "state_change"
    ERROR = "error"


@dataclass
class Observation:
    type: ObservationType
    timestamp: datetime
    data: dict
    context: Optional[str] = None


class HealthStatus(Enum):
    HEALTHY = "healthy"
    DEGRADED = "degraded"
    CRITICAL = "critical"


class Recommendation(Enum):
    CONTINUE = "continue"
    CHECKPOINT = "checkpoint"
    ESCALATE = "escalate"
    ABORT = "abort"


@dataclass
class LoopDetection:
    detected: bool
    pattern: Optional[str] = None
    count: int = 0
    observations: List[Observation] = None
    
    def __post_init__(self):
        if self.observations is None:
            self.observations = []


@dataclass
class ThrashingDetection:
    detected: bool
    pattern: Optional[str] = None
    affected_files: List[str] = None
    alternation_count: int = 0
    
    def __post_init__(self):
        if self.affected_files is None:
            self.affected_files = []


@dataclass
class AgentHealth:
    status: HealthStatus
    issues: List[str]
    recommendation: Recommendation
    loop_detection: Optional[LoopDetection] = None
    thrashing_detection: Optional[ThrashingDetection] = None
    drift_score: float = 0.0
    context_pressure: float = 0.0
    progress_score: float = 0.0
