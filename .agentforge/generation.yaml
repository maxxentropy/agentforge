# LLM Generation Configuration
# =============================
#
# Settings for the LLM code generation component.
# API key should be set via ANTHROPIC_API_KEY environment variable.

# Model settings
model:
  # Default model for code generation
  default: "claude-sonnet-4-20250514"

  # Alternative models for different use cases
  alternatives:
    fast: "claude-3-5-haiku-20241022"  # Quick iterations
    powerful: "claude-sonnet-4-20250514"  # Complex generation

# Token limits
tokens:
  # Maximum tokens per generation request
  max_output: 8192

  # Reserved tokens for prompt (estimate based on context size)
  prompt_reserve: 4096

  # Warning threshold (percentage of budget)
  warning_threshold: 80

# Retry configuration
retry:
  # Maximum retry attempts for API errors
  max_attempts: 3

  # Initial delay between retries (seconds)
  initial_delay: 1.0

  # Exponential backoff multiplier
  backoff_multiplier: 2.0

  # Maximum delay between retries (seconds)
  max_delay: 30.0

# File output settings
output:
  # Header comment added to generated files
  header_template: |
    # Generated by AgentForge
    # Spec: {spec_name}
    # Phase: {phase}
    # Date: {timestamp}

  # Backup directory for overwritten files
  backup_dir: ".agentforge/backups"

  # Enable atomic writes (recommended)
  atomic_writes: true

# Phase-specific settings
phases:
  red:
    # Instructions for test generation
    focus: "Generate failing tests that verify specification requirements"
    style: "pytest with clear arrange-act-assert structure"

  green:
    # Instructions for implementation generation
    focus: "Generate minimal implementation to pass tests"
    style: "Follow existing project patterns and conventions"

  refactor:
    # Instructions for refactoring
    focus: "Improve code quality without changing behavior"
    style: "Extract patterns, reduce duplication, improve naming"

# Manual mode (when no API key)
manual:
  # Prompt output file
  prompt_file: ".agentforge/generation_prompt.txt"

  # Response input file
  response_file: ".agentforge/generation_response.txt"

  # Instructions message
  instructions: |
    No API key found. Running in manual mode.
    1. Prompt saved to: {prompt_file}
    2. Copy prompt to Claude (claude.ai or API)
    3. Save response to: {response_file}
    4. Run: agentforge generate parse-response {response_file}
