# ═══════════════════════════════════════════════════════════════════════════════
# Specification: core_discovery
# ═══════════════════════════════════════════════════════════════════════════════
# Generated: 2026-01-01T16:07:59.230970
# Generator: brownfield-discovery
# ═══════════════════════════════════════════════════════════════════════════════

spec_id: core-discovery-v1
name: core_discovery
version: '1.0'
status: as-built
schema_version: '2.0'
generated_at: '2026-01-01T16:07:59.230970'
generated_by: brownfield-discovery
description: Specification for src/agentforge/core/discovery
components:
- name: domain
  component_id: core-discovery-domain
  location: src/agentforge/core/discovery/domain.py
  test_location: tests/unit/tools/test_builtin_checks_architecture.py
  description: 'Brownfield Discovery Domain Model

    =================================


    Pure domain objects for discovery operations. No I/O operations.

    These entities represent detected patterns, conventions, and structure.'
  entities:
  - name: DetectionSource
    type: enum
    line_number: 16
    description: How a value was determined.
    methods: []
    test_methods: []
  - name: ConfidenceLevel
    type: enum
    line_number: 28
    description: Confidence classification for detections.
    methods:
    - from_score
    test_methods: []
  - name: DiscoveryPhase
    type: enum
    line_number: 48
    description: Phases of discovery process.
    methods: []
    test_methods: []
  - name: OnboardingStatus
    type: enum
    line_number: 58
    description: Status of module onboarding.
    methods: []
    test_methods: []
  - name: ZoneDetectionMode
    type: enum
    line_number: 66
    description: How zone was detected.
    methods: []
    test_methods: []
  - name: InteractionType
    type: enum
    line_number: 73
    description: Types of cross-zone interactions.
    methods: []
    test_methods: []
  - name: Detection
    type: dataclass
    line_number: 85
    description: A detection with confidence and evidence tracking.
    methods:
    - confidence_level
    - to_dict
    test_methods:
    - test_max_depth_limits_detection
    - test_loop_detection_creation_not_detected
    - test_loop_detection_creation_detected
    - test_thrashing_detection_creation_not_detected
    - test_thrashing_detection_creation_detected
    - test_agent_health_creation_critical_with_detections
    - test_get_health_with_loop_detection
    - test_get_health_with_thrashing_detection
    - test_incremental_detection_on_observe
    - test_multiple_detection_types_simultaneously
  - name: LanguageInfo
    type: dataclass
    line_number: 112
    description: Detected programming language.
    methods:
    - to_dict
    test_methods: []
  - name: ProjectInfo
    type: dataclass
    line_number: 135
    description: Information about a detected project.
    methods: []
    test_methods: []
  - name: LayerInfo
    type: dataclass
    line_number: 147
    description: Detected architectural layer.
    methods:
    - has_violations
    - to_dict
    test_methods: []
  - name: ArchitectureViolation
    type: dataclass
    line_number: 173
    description: A detected architecture layer violation.
    methods: []
    test_methods: []
  - name: PatternDetection
    type: dataclass
    line_number: 186
    description: A detected coding pattern.
    methods:
    - to_dict
    test_methods: []
  - name: ConventionDetection
    type: dataclass
    line_number: 207
    description: A detected naming or organization convention.
    methods:
    - to_dict
    test_methods: []
  - name: TestInventory
    type: dataclass
    line_number: 225
    description: Inventory of tests in the codebase.
    methods: []
    test_methods: []
  - name: TestGap
    type: dataclass
    line_number: 234
    description: An identified gap in test coverage.
    methods: []
    test_methods: []
  - name: TestLinkage
    type: dataclass
    line_number: 242
    description: 'Links a source file to its test file(s).


      This is the critical data structure for the fix workflow - it tells

      exactly which tests verify a given source file. Generated by brownfield

      discovery through import analysis and naming conventions.'
    methods:
    - to_dict
    test_methods: []
  - name: TestAnalysis
    type: dataclass
    line_number: 265
    description: Results of test gap analysis.
    methods:
    - get_test_path
    - to_dict
    test_methods: []
  - name: Zone
    type: dataclass
    line_number: 298
    description: 'A coherent area of code with its own language, patterns, and conventions.


      Zones enable multi-language repository support. Each zone is independently

      analyzed and can have its own conformance contracts.'
    methods:
    - to_dict
    - contains_path
    test_methods:
    - test_build_contract_default_zone
    - test_handles_special_characters_in_zone_name
  - name: Interaction
    type: dataclass
    line_number: 334
    description: 'A detected cross-zone interaction.


      Interactions capture how different zones communicate - through HTTP APIs,

      shared schemas, docker-compose orchestration, etc.'
    methods:
    - to_dict
    test_methods: []
  - name: ZoneProfile
    type: dataclass
    line_number: 366
    description: 'Per-zone discovery results.


      Each zone gets its own profile with language-specific patterns,

      structure, and conventions. This enables different analysis

      strategies per zone.'
    methods:
    - to_dict
    test_methods: []
  - name: DependencyInfo
    type: dataclass
    line_number: 402
    description: Information about an external dependency.
    methods: []
    test_methods: []
  - name: DiscoveryMetadata
    type: dataclass
    line_number: 413
    description: Metadata about a discovery run.
    methods: []
    test_methods: []
  - name: OnboardingProgress
    type: dataclass
    line_number: 424
    description: Tracks incremental onboarding progress.
    methods:
    - is_complete
    test_methods: []
  - name: CodebaseProfile
    type: dataclass
    line_number: 434
    description: 'Complete profile of a discovered codebase.


      This is the primary output of brownfield discovery.'
    methods:
    - to_dict
    test_methods: []
- name: manager
  component_id: core-discovery-manager
  location: src/agentforge/core/discovery/manager.py
  test_location: tests/unit/tools/conformance/test_manager.py
  description: 'Discovery Manager

    =================


    Orchestrates the brownfield discovery process through multiple phases.'
  entities:
  - name: DiscoveryPhaseStatus
    type: enum
    line_number: 38
    description: Status of a discovery phase.
    methods: []
    test_methods: []
  - name: PhaseResult
    type: dataclass
    line_number: 48
    description: Result of a single discovery phase.
    methods: []
    test_methods: []
  - name: DiscoveryResult
    type: dataclass
    line_number: 58
    description: Complete result of discovery process.
    methods: []
    test_methods: []
  - name: DiscoveryManager
    type: class
    line_number: 71
    description: 'Orchestrates the brownfield discovery process.


      Runs discovery in phases:

      1. Language Detection - What languages/frameworks?

      2. Structure Analysis - How is it organized?

      3. Pattern Extraction - What patterns are used?

      4. Architecture Mapping - What are the dependencies?

      5. Convention Inference - What naming conventions? (future)

      6. Test Gap Analysis - What''s tested? (future)'
    methods:
    - discover
    test_methods: []
  - name: MultiZoneDiscoveryResult
    type: dataclass
    line_number: 536
    description: Result of multi-zone discovery process.
    methods: []
    test_methods: []
  - name: MultiZoneDiscoveryManager
    type: class
    line_number: 548
    description: "Orchestrates multi-zone brownfield discovery.\n\nDetects zones,\
      \ analyzes each zone independently, and\ndetects cross-zone interactions.\n\n\
      Example:\n    >>> manager = MultiZoneDiscoveryManager(Path(\"/my/repo\"))\n\
      \    >>> result = manager.discover()\n    >>> for zone_name, profile in result.zone_profiles.items():\n\
      \    ...     print(f\"{zone_name}: {profile.zone.language}\")"
    methods:
    - discover
    - list_zones
    test_methods: []
